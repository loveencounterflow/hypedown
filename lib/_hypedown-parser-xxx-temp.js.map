{
  "version": 3,
  "file": "",
  "sourceRoot": "",
  "sources": [
    "../src/_hypedown-parser-xxx-temp.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n\n############################################################################################################\nGUY                       = require 'guy'\n{ alert\n  debug\n  help\n  info\n  plain\n  praise\n  urge\n  warn\n  whisper }               = GUY.trm.get_loggers 'HYPEDOWN-PARSER/XXX-TEMP-HTML'\n#...........................................................................................................\n{ rpr\n  inspect\n  echo\n  log     }               = GUY.trm\n#...........................................................................................................\n{ DATOM }                 = require 'datom'\n#...........................................................................................................\n{ new_datom\n  lets\n  stamp }                = DATOM\n#...........................................................................................................\n{ Pipeline\n  Pipeline_module\n  $\n  transforms }            = require 'moonriver'\n#...........................................................................................................\n{ misfit\n  get_base_types }        = require './types'\nE                         = require './errors'\nH                         = require './helpers'\n{ Hypedown_lexer }        = require './_hypedown-lexer'\n\n\n#===========================================================================================================\nclass @$001_Prelude extends Pipeline_module\n\n\n#===========================================================================================================\nclass @$010_prepare_paragraphs extends Pipeline_module\n\n  #---------------------------------------------------------------------------------------------------------\n  $inject_virtual_nl: ->\n    ### normalize start of document by injecting two newlines. ###\n    is_first  = true\n    mode      = 'plain'\n    tid       = 'nl'\n    mk        = \"#{mode}:#{tid}\"\n    return ( d, send ) ->\n      return send d unless is_first\n      is_first = false\n      send { mode, tid, mk, jump: null, value: '', lnr1: 1, x1: 0, lnr2: 1, x2: 0, \\\n        data: { virtual: true, }, $key: '^plain', $: 'inject_virtual_nl', }\n      send { mode, tid, mk, jump: null, value: '', lnr1: 1, x1: 0, lnr2: 1, x2: 0, \\\n        data: { virtual: true, }, $key: '^plain', $: 'inject_virtual_nl', }\n      send d\n\n  #---------------------------------------------------------------------------------------------------------\n  $add_parbreak_markers: -> ### needs inject_virtual_nl ###\n    newline_mk  = 'plain:nl'\n    mk          = 'html:parbreak'\n    p           = new Pipeline()\n    template    = { \\\n        mode: 'html', tid: 'parbreak', mk, value: '', \\\n        $key: '^html', $: 'add_parbreak_markers', }\n    # p.push window = transforms.$window { min: -3, max: +3, empty: null, }\n    # p.push ( ds, send ) -> help '^3242^', d?.mk ? '---' for d in ds; send ds.at 3\n    p.push window = transforms.$window { min: -2, max: 0, empty: null, }\n    # p.push ( ds ) -> urge '^3242^', d?.mk ? '---' for d in ds\n    p.push add_parbreak_markers = ( [ lookbehind, previous, current, ], send ) ->\n      # debug '^3242^', [ lookbehind?.mk, previous?.mk, current?.mk, ]\n      # debug '^3242^', previous if previous? and not previous.mk?\n      return send current unless ( H.select_token lookbehind,  newline_mk )\n      return send current unless ( H.select_token previous,    newline_mk )\n      return send current if     ( H.select_token current,     newline_mk )\n      send { template..., ( GUY.props.pick_with_fallback current, null, 'lnr1', 'x1', 'lnr2', 'x2', )..., }\n      send current\n    # p.push ( d ) -> info '^3242^', d.mk, rpr d.value\n    return p\n\n#===========================================================================================================\nclass @$020_priority_markup extends Pipeline_module\n  ### 'Priority markup': markup that blocks parsing of its contents, like codespans, in which stuff like\n  stars and double stars do not lead to `<em>`, `<strong>` tags ###\n\n  #---------------------------------------------------------------------------------------------------------\n  $parse_md_codespan: ->\n    ### TAINT consider to rewrite using `$window()` transform ###\n    ### TAINT use CFG pattern ###\n    ### TAINT use API for `mode:key` IDs ###\n    enter_mk  = \"plain:codespan\"\n    exit_mk   = \"cspan:codespan\"\n    text_mk   = \"cspan:text\"\n    escchr_mk = \"cspan:escchr\"\n    collector = []\n    #.......................................................................................................\n    flush = ->\n      last_idx      = collector.length - 1\n      first_txt_idx = 1\n      last_txt_idx  = last_idx - 1\n      lnr1          = ( collector.at  0 ).lnr1\n      lnr2          = ( collector.at -1 ).lnr2\n      x1            = ( collector.at  0 ).x1\n      x2            = ( collector.at -1 ).x2\n      texts         = []\n      #.....................................................................................................\n      for d, idx in collector\n        if ( idx is 0 )\n          yield stamp d\n          yield H.XXX_new_token 'parse_md_codespan', d, 'html', 'tag', 'code', '<code>'\n          continue\n        else if ( idx is last_idx )\n          yield stamp d\n          yield H.XXX_new_token 'parse_md_codespan', d, 'html', 'tag', 'code', '</code>'\n          continue\n        #...................................................................................................\n        switch d.mk\n          when text_mk\n            if      idx is first_txt_idx  then  texts.push d.value.trimStart()\n            else if idx is last_txt_idx   then  texts.push d.value.trimEnd()\n            else                                texts.push d.value\n          when escchr_mk\n            ### TAINT must properly resolve escaped character ###\n            texts.push d.data.chr\n          else\n            throw new Error \"^^parse_md_codespan@32\", \"internal error: unhandled token #{rpr d}\"\n        #...................................................................................................\n        if ( idx is last_txt_idx )\n          value = texts.join ''\n          ### TAINT should not use `html` or must escape first ###\n          yield { mode: 'html', tid: 'text', mk: 'html:text', value, lnr1, x1, lnr2, x2, }\n      #.....................................................................................................\n      collector.length = 0\n      return null\n    #.......................................................................................................\n    return parse_md_codespan = ( d, send ) ->\n      switch d.mk\n        when enter_mk, text_mk, escchr_mk\n          send stamp d\n          collector.push d\n        when exit_mk\n          collector.push d\n          send e for e from flush()\n        else\n          send d\n      return null\n\n\n#===========================================================================================================\nclass @$030_htmlish_tags extends Pipeline_module\n  $: ( require './_hypedown-parser-htmlish' ).Hypedown_parser_htmlish\n\n\n#===========================================================================================================\nclass @$040_stars extends Pipeline_module\n  $: ( require './_hypedown-parser-stars' ).Hypedown_parser_md_stars\n\n\n#===========================================================================================================\nclass @$050_hash_headings extends Pipeline_module\n  $: ->\n    mode          = 'plain'\n    tid           = 'hashes'\n    hashes_mk     = \"#{mode}:#{tid}\"\n    parbreak_mk   = 'html:parbreak'\n    prv_was_empty = false\n    p             = new Pipeline()\n    p.push window = transforms.$window { min: -1, max: 0, empty: null, }\n    p.push add_headings = ( [ previous, d, ], send ) ->\n      return send d unless ( previous?.mk is parbreak_mk ) and ( d.mk is hashes_mk )\n      send stamp d\n      name = \"h#{d.data.text.length}\"\n      send H.XXX_new_token '050_hash_headings', d, 'html', 'tag', name, \"<#{name}>\"\n      return null\n    return p\n\n"
  ]
}